---
title: "[Python] ê°€ì¥ ê¸´ ì¦ê°€í•˜ëŠ” ë¶€ë¶„ ìˆ˜ì—´ (LIS)"
description: 
date: 2025-03-27 23:44:54 +0900
categories:
  - PS
tags:
  - python
pin: false
comments: true
---
## LIS(Longest Increasing Subsequence) ì•Œê³ ë¦¬ì¦˜

ì£¼ì–´ì§„ ìˆ˜ì—´ì—ì„œ ì¼ë¶€ ì›ì†Œë¥¼ ì œê±°í•´ **ìˆœì„œë¥¼ ìœ ì§€í•œ ì±„** ê°€ì¥ ê¸¸ê²Œ ì¦ê°€í•˜ëŠ” ë¶€ë¶„ ìˆ˜ì—´ì„ ì°¾ëŠ” ë¬¸ì œë‹¤.  
`O(N^2)` í’€ì´(DP)ì™€ `O(N log N)` í’€ì´(ì´ë¶„ íƒìƒ‰)ê°€ ìˆë‹¤.


---

## 1ï¸âƒ£ DP í’€ì´ (O(N^2))

### ë¬¸ì œ: [ë°±ì¤€ 11053ë²ˆ](https://www.acmicpc.net/problem/11053)

```python
# dp
N = int(input())
dp = [0 for _ in range(N+1)]  
# dp[i]: ië²ˆì§¸ ì›ì†Œë¥¼ ë§ˆì§€ë§‰ìœ¼ë¡œ í•˜ëŠ” ì¦ê°€í•˜ëŠ” ë¶€ë¶„ ìˆ˜ì—´ë“¤ ì¤‘ ê°€ì¥ ê¸´ ê²ƒì˜ ê¸¸ì´

A = [0] + list(map(int, input().split()))
for i in range(1, N+1):
    max_num = 0
    for j in range(i):
        if A[j] < A[i]:
            max_num = max(max_num, dp[j])
    dp[i] = max_num + 1
print(max(dp))
```

dpë¡œ í’€ ìˆ˜ ìˆë‹¤. ì´ì¤‘ ë°˜ë³µë¬¸ìœ¼ë¡œ, ì‹œê°„ë³µì¡ë„ëŠ” `O(N^2)`ë‹¤.


### ë¬¸ì œ: [ë°±ì¤€ 14002ë²ˆ](https://www.acmicpc.net/problem/14002)

ì´ ë¬¸ì œëŠ” ì•ì„  ë¬¸ì œì—ì„œ ì¶”ê°€ë¡œ **ë¶€ë¶„ ìˆ˜ì—´ì„ ì¶œë ¥**í•´ì•¼ í•˜ëŠ” ë¬¸ì œë‹¤. 

**ì´ë•Œ `dp[i]`ê°€ ê°€ì¥ í° ê°’ë¶€í„° ì—­ìˆœìœ¼ë¡œ ì¶”ì í•´ì•¼ í•œë‹¤.** ì—­ìˆœìœ¼ë¡œ ì•ˆ ì°¾ê³  ì•ì—ì„œë¶€í„° ì°¾ìœ¼ë©´, ë‹¤ìŒì— ë‚˜ì˜¤ëŠ” ë” ì‘ì€(=ìµœì í™”ëœ) ê°’ë“¤ì„ ë†“ì¹˜ê¸° ë•Œë¬¸ì— í‹€ë¦°ë‹¤.

```
Input
7
10 20 30 21 22 23 40

Output
6
10 20 30 22 23 40 (ë•¡!)
```


ê·¸ë˜ì„œ í•˜ë‹¨ì— ì´ë ‡ê²Œ ì½”ë“œë¥¼ ì¶”ê°€í•´ì•¼ í•œë‹¤.

```python
# ë¶€ë¶„ ìˆ˜ì—´ ì¶œë ¥ì„ ìœ„í•œ ì—­ì¶”ì 
ans = []
now = max(dp)
for i in range(len(dp)-1, 0, -1):
    if dp[i] == now:
        ans.append(A[i])
        now -= 1
ans.reverse()
for elem in ans:
    print(elem, end=' ')
print()
```




----


## 2ï¸âƒ£ O(N log N) í’€ì´: ì´ë¶„ íƒìƒ‰ í™œìš©

### ë¬¸ì œ: [ë°±ì¤€ 12015ë²ˆ](https://www.acmicpc.net/problem/12015)

ì²«ë²ˆì§¸ ë¬¸ì œë‘ ë˜‘ê°™ì€ë°, ì´ë²ˆì—ëŠ” `N`ì´ ìµœëŒ€ `1,000,000`ê¹Œì§€ë¡œ ëŠ˜ì–´ë‚˜ì„œ ê¸°ì¡´ì˜ `O(N^2)`í’€ì´ë¡œëŠ” ì‹œê°„ ì´ˆê³¼ê°€ ë°œìƒí•œë‹¤. ê·¸ë˜ì„œ ì´ë²ˆì—ëŠ” dpê°€ ì•„ë‹Œ, **ì´ë¶„ íƒìƒ‰ì„ ì´ìš©í•œ LIS**ë¥¼ ì‚¬ìš©í•´ì•¼ í•œë‹¤.

**ê³¼ì •**
1. ë¹ˆ ë¦¬ìŠ¤íŠ¸ë¥¼ í•œ ê°œ ë§Œë“ ë‹¤(ì´ë¦„ì€ `l`ë¡œ í–ˆë‹¤). ì´ ë¦¬ìŠ¤íŠ¸ì˜ ê¸¸ì´ëŠ” ë‚˜ì¤‘ì— LISì˜ ê¸¸ì´ê°€ ëœë‹¤.
2. ì…ë ¥ëœ ìˆ«ìë¥¼ í•œ ê°œì”© ë³¸ë‹¤.
3. í˜„ì¬ `l`ì˜ ë§ˆì§€ë§‰ ì›ì†Œë³´ë‹¤ í° ê²½ìš°, `l`ì— **ê·¸ëƒ¥ ì¶”ê°€í•œë‹¤**.
4. ì‘ê±°ë‚˜ ê°™ì€ ê²½ìš°, **ì´ë¶„ íƒìƒ‰ì„ ì´ìš©í•´ `l`ì˜ ì ì ˆí•œ ìœ„ì¹˜(lower bound)ë¥¼ ì°¾ì€ ë‹¤ìŒ, í•´ë‹¹ ìœ„ì¹˜ì˜ ê°’ì„ ì´ê±¸ë¡œ êµì²´**í•œë‹¤.
5. ì™„ì„±ëœ ìµœì¢… `l`ì˜ ê¸¸ì´ê°€ LISì˜ ê¸¸ì´ì™€ ê°™ë‹¤.

```
Input
7
3 5 7 1 2 8 6

ê³¼ì •:
1. [3]
2. [3, 5]
3. [3, 5, 7]
4. [1, 5, 7]  (1ì´ ë“¤ì–´ì™€ ì ì ˆí•œ ìœ„ì¹˜ì— ëŒ€ì²´)
5. [1, 2, 7]  (2ê°€ ë“¤ì–´ì™€ ì ì ˆí•œ ìœ„ì¹˜ì— ëŒ€ì²´)
6. [1, 2, 7, 8]  (8 ì¶”ê°€)
7. [1, 2, 6, 8]  (6ì´ ë“¤ì–´ì™€ ì ì ˆí•œ ìœ„ì¹˜ì— ëŒ€ì²´)
ê²°ê³¼: LIS ê¸¸ì´ = 4

Output
4
```

ì½”ë“œëŠ” ë‹¤ìŒê³¼ ê°™ì´ ì‘ì„±í–ˆë‹¤(íŒŒì´ì¬ì—ì„œëŠ” ì´ë¶„íƒìƒ‰ì„ ìœ„í•´ bisect ë¼ì´ë¸ŒëŸ¬ë¦¬ì˜ bisect_left í•¨ìˆ˜ë¥¼ ì‚¬ìš©í•´ë„ ëœë‹¤).

```python
def lower_bound(arr, target):
    left = 0
    right = len(arr) - 1
    while left < right:
        mid = (left + right) // 2
        if arr[mid] < target:
            left = mid + 1
        else:
            right = mid
    return right

N = int(input())
A = list(map(int, input().split()))
l = []

for i in range(N):
    if i == 0:
        l.append(A[i])
    else:
        if A[i] > l[-1]:
            l.append(A[i])
        else:
            # lower bound ì°¾ì•„ì„œ ê°±ì‹ 
            index = lower_bound(l, A[i])
            l[index] = A[i]

print(len(l))
```

ì´ë ‡ê²Œ í•˜ë©´ ì‹œê°„ë³µì¡ë„ê°€ `O(NlogN)`ì´ ë˜ì–´ì„œ í†µê³¼í•  ìˆ˜ ìˆë‹¤.

### ë¬¸ì œ: [ë°±ì¤€ 14003ë²ˆ](https://www.acmicpc.net/problem/14003)

ë§ˆì§€ë§‰ìœ¼ë¡œ ì´ ë¬¸ì œë¥¼ ë³´ì. 
ì´ ë¬¸ì œì—ì„œëŠ” `O(NlogN)` ìœ¼ë¡œ í’€ë©´ì„œ, ë¶€ë¶„ ìˆ˜ì—´ ì¶œë ¥ë„ í•´ì•¼ í•œë‹¤. 
ì´ë•Œ ì¤‘ìš”í•œ ê±´ **LIS ì•Œê³ ë¦¬ì¦˜ìœ¼ë¡œ êµ¬í•œ `l`ì€ LISì˜ ê¸¸ì´ë§Œ ìœ ì§€í•˜ëŠ” ë°°ì—´ì´ì§€, ì‹¤ì œ LISë¥¼ ì €ì¥í•˜ëŠ” ê²ƒì€ ì•„ë‹ˆë¼ëŠ” ì **ì´ë‹¤. ë‚˜ëŠ” ì²˜ìŒì— ì´ê±¸ ê°„ê³¼í•´ì„œ `l`ì„ ê·¸ëƒ¥ ì¶œë ¥í–ˆë‹¤ê°€ `í‹€ë ¸ìŠµë‹ˆë‹¤`ë¥¼ ë°›ì•˜ë‹¤(ê°ì!).

```
Input
7
3 5 7 1 2 8 6

Output
4
1 2 6 8 (ë•¡!)
```


ë¶€ë¶„ ìˆ˜ì—´ì„ ì¶œë ¥í•˜ê¸° ìœ„í•´ì„œëŠ” ì¤‘ê°„ì— ë‹¤ë¥¸ ì¶”ê°€ì ì¸ ì‘ì—…ì„ í•´ì¤˜ì•¼ í•œë‹¤.
ë§¤ ìš”ì†Œì—ì„œ lower bound ì°¾ì•„ì„œ ê°±ì‹ í•˜ëŠ” ê³¼ì •ì—ì„œ, í•´ë‹¹ ìš”ì†Œì˜ lower boundê°€ ì–¼ë§ˆì˜€ëŠ”ì§€ë¥¼ ë”°ë¡œ `bounds` ë¦¬ìŠ¤íŠ¸ë¥¼ ë§Œë“¤ì–´ ì €ì¥í•´ì¤¬ë‹¤.
ê·¸ë¦¬ê³  ë§ˆì§€ë§‰ì— `bounds`ë¥¼ ì—­ì¶”ì í•´ì„œ ë¶€ë¶„ ìˆ˜ì—´ì„ ì°¾ì•˜ë‹¤.

```python
.
.
.
N = int(input())
A = list(map(int, input().split()))
l = []
# lower boundë¥¼ ì°¾ì„ ë•Œë§ˆë‹¤ indexë¥¼ ì €ì¥í•´ë†“ê³ , ê·¸ indexë¥¼ ì—­ì¶”ì í•´ì„œ ë¶€ë¶„ ìˆ˜ì—´ì„ ì°¾ì•„ì•¼ í•¨
bounds = [0 for _ in range(N)]

for i in range(N):
    if i == 0:
        l.append(A[i])
        bounds[i] = 0
    else:
        if A[i] > l[-1]:
            l.append(A[i])
            bounds[i] = len(l) - 1
        else:
            # lower bound ì°¾ì•„ì„œ ê°±ì‹ 
            index = lower_bound(l, A[i])
            l[index] = A[i]
            bounds[i] = index

print(len(l))

# ë¶€ë¶„ ìˆ˜ì—´ ì¶œë ¥: ì—­ì¶”ì í•´ì„œ ê°€ì¥ ìµœì í™”ëœ ë¶€ë¶„ ìˆ˜ì—´ì„ ì°¾ì•„ì•¼ í•¨
ans = []
now = max(bounds)
for i in range(len(bounds)-1, -1, -1):
    if bounds[i] == now:
        ans.append(A[i])
        now -= 1
ans.reverse()
for elem in ans:
    print(elem, end=' ')
print()

```


---

## ğŸ“– ì •ë¦¬

- `O(N^2)` í’€ì´ (DP)
- `O(N log N)` í’€ì´ (ì´ë¶„ íƒìƒ‰)
-  **LISëŠ” ì €ì¥ë˜ì§€ ì•ŠëŠ”ë‹¤.** ë¶€ë¶„ ìˆ˜ì—´ ì¶œë ¥ì„ ìœ„í•´ì„œëŠ” ë”°ë¡œ **ì—­ì¶”ì ** ë¡œì§ì„ ì¶”ê°€í•´ì•¼ í•œë‹¤.

ì–´ë µë‹¤...ê¼­ ë³µìŠµí•˜ì. 
ê·¼ë° ì „ë¶€ í’€ê³  ë‚˜ë‹ˆê¹Œ í‹°ì–´ ì ìˆ˜ê°€ ì—„ì²­ ì˜¬ëë‹¤ğŸ˜Š


## ì°¸ê³ 

[ë°±ì¤€ 14003(ê°€ì¥ ê¸´ ì¦ê°€í•˜ëŠ” ë¶€ë¶„ ìˆ˜ì—´ 5)](https://hblog.tistory.com/8)